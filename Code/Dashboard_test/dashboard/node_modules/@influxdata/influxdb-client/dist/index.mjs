import{parse as t}from"url";import{request as e}from"http";import{request as s}from"https";import{Buffer as r}from"buffer";import n from"zlib";const i={timeout:1e4},o=Object.freeze({retryJitter:200,minRetryDelay:1e3,maxRetryDelay:15e3}),h=Object.freeze(Object.assign({batchSize:1e3,flushInterval:6e4,writeFailed:function(){},maxRetries:2,maxBufferLines:32e3},o)),l=[404,408,425,429,500,502,503,504];function c(t){return l.includes(t)}class a extends Error{constructor(t){super(t),Object.setPrototypeOf(this,a.prototype)}}class u extends Error{constructor(t,e,s,r){super(),this.statusCode=t,this.statusMessage=e,this.body=s,Object.setPrototypeOf(this,u.prototype),this.message=s?`${t} ${e} : ${s}`:`${t} ${e}`,this.setRetryAfter(r)}setRetryAfter(t){"string"==typeof t&&/^[0-9]+$/.test(t)?this._retryAfter=parseInt(t):this._retryAfter=0}canRetry(){return c(this.statusCode)}retryAfter(){return this._retryAfter}}const f=["ECONNRESET","ENOTFOUND","ESOCKETTIMEDOUT","ETIMEDOUT","ECONNREFUSED","EHOSTUNREACH","EPIPE"];function d(t){return!!t&&("function"==typeof t.canRetry?!!t.canRetry():!(!t.code||!f.includes(t.code)))}function p(t,e){if(t){let s;return"function"==typeof t.retryAfter?t.retryAfter():(s=0,e&&e>0?s+Math.round(Math.random()*e):s)}return 0}class g extends Error{constructor(){super(),Object.setPrototypeOf(this,g.prototype),this.message="Request timed out"}canRetry(){return!0}retryAfter(){return 0}}class m extends Error{constructor(){super(),this.name="AbortError",Object.setPrototypeOf(this,m.prototype),this.message="Response aborted"}canRetry(){return!0}retryAfter(){return 0}}const y=/[-|\\{()[\]^$+*?.]/g;class w{constructor(t,e=""){this.wrap=e;const s=t.join("").replace(y,"\\$&");this._re=new RegExp("["+s+"]","g")}escape(t){this._re.lastIndex=0;let e=this._re.lastIndex,s="",r=this._re.exec(t);for(;r;)s+=t.slice(e,r.index)+"\\"+r[0],e=this._re.lastIndex,r=this._re.exec(t);return 0===e?this.wrap+t+this.wrap:e<t.length?this.wrap+s+t.slice(e)+this.wrap:this.wrap+s+this.wrap}}const b=t=>t.escape.bind(t),x={measurement:b(new w([","," "])),quoted:b(new w(['"',"\\\\"],'"')),tag:b(new w([",","="," "]))};let S=!1;function O(t){return S=t&&process&&"function"==typeof process.hrtime}O(!0);let v=void 0,R=void 0,T=Date.now(),$=0;function E(){if(S){const t=process.hrtime();let e=Date.now();R?(t[0]=t[0]-R[0],t[1]=t[1]-R[1],t[1]<0&&(t[0]-=1,t[1]+=1e9),e=v+1e3*t[0]+Math.floor(t[1]/1e6)):(R=t,v=e);const s=String(t[1]%1e6);return String(e)+"000000000".substr(0,6-s.length)+s}{const t=Date.now();t!==T?(T=t,$=0):$++;const e=String($);return String(t)+"000000000".substr(0,6-e.length)+e}}function _(){if(S){const t=process.hrtime(),e=String(Math.trunc(t[1]/1e3)%1e3);return String(Date.now())+"000000000".substr(0,3-e.length)+e}return String(Date.now())+"000000000".substr(0,3)}function C(){return String(Date.now())}function j(){return String(Math.floor(Date.now()/1e3))}const D=Object.freeze({[String("s")]:j,[String("ms")]:C,[String("us")]:_,[String("ns")]:E,seconds:j,millis:C,micros:_,nanos:E}),L={[String("s")]:t=>`${Math.floor(t.getTime()/1e3)}`,[String("ms")]:t=>`${t.getTime()}`,[String("us")]:t=>`${t.getTime()}000`,[String("ns")]:t=>`${t.getTime()}000000`},A=t=>t,P={boolean:t=>"true"===t,unsignedLong:A,long:A,double:t=>+t,string:A,base64Binary:A,dateTime:A,duration:A};class B{constructor(t){t.forEach((t,e)=>t.index=e),this.columns=t}column(t){for(let e=0;e<this.columns.length;e++){const s=this.columns[e];if(s.label===t)return s}throw new a(`Column ${t} not found!`)}toObject(t){const e={};for(let s=0;s<this.columns.length&&s<t.length;s++){let r=t[s];const n=this.columns[s];""===r&&n.defaultValue&&(r=n.defaultValue),e[n.label]=(P[n.dataType]||A)(r)}return e}}class M{static from(t){const e=new M;return e.label=t.label,e.dataType=t.dataType,e.group=Boolean(t.group),e.defaultValue=t.defaultValue||"",e}}const k=Symbol("FLUX_VALUE");class z{constructor(t){this.fluxValue=t}toString(){return this.fluxValue}[k](){return this.fluxValue}}function q(t){if(null==t)return"";t=t.toString();let e=void 0,s=0;function r(){void 0===e&&(e=t.substring(0,s))}for(;s<t.length;s++){const n=t.charAt(s);switch(n){case"\r":r(),e+="\\r";break;case"\n":r(),e+="\\n";break;case"\t":r(),e+="\\t";break;case'"':case"\\":r(),e=e+"\\"+n;break;case"$":if(s+1<t.length&&"{"===t.charAt(s+1)){r(),s++,e+="\\${";break}null!=e&&(e+=n);break;default:null!=e&&(e+=n)}}return void 0!==e?e:t}function U(t){return new z(`"${q(t)}"`)}function F(t){const e=String(t);for(const t of e)if(t<"0"||t>"9")throw new Error(`not a flux integer: ${e}`);return new z(e)}function N(t){const e=String(t);let s=!1;for(const t of e){if("."===t){if(s)throw new Error(`not a flux float: ${e}`);s=!s}if("."!==t&&(t<"0"||t>"9"))throw new Error(`not a flux float: ${e}`)}return e}function I(t){return new z(N(t))}function H(t){return new z(function(t){return`time(v: "${q(t)}")`}(t))}function V(t){return new z(`duration(v: "${q(t)}")`)}function J(t){return`regexp.compile(v: "${q(t)}")`}function W(t){return new z(J(t))}function Y(t){return new z("true"===t||"false"===t?t:(!!t).toString())}function Z(t){return new z(String(t))}function G(t){return void 0===t?"":null===t?"null":"boolean"==typeof t?t.toString():"string"==typeof t?`"${q(t)}"`:"number"==typeof t?N(t):"object"==typeof t&&"function"==typeof t[k]?t[k]():t instanceof Date?t.toISOString():t instanceof RegExp?J(t):G(t.toString())}function K(t,...e){if(1==t.length&&(!e||0===e.length))return t[0];const s=new Array(t.length+e.length);let r=0;for(let n=0;n<t.length;n++){const i=t[n];if(s[r++]=i,n<e.length){const o=e[n];let h;if(i.endsWith('"')&&n+1<t.length&&t[n+1].startsWith('"'))h=q(o);else if(h=G(o),""===h)throw new Error(`Unsupported parameter literal '${o}' at index: ${n}, type: ${typeof o}`);s[r++]=h}else if(n<t.length-1)throw new Error("Too few parameters supplied!")}return Z(s.join(""))}class Q{constructor(t){this.tags={},this.fields={},t&&(this.name=t)}measurement(t){return this.name=t,this}tag(t,e){return this.tags[t]=e,this}booleanField(t,e){return this.fields[t]=e?"T":"F",this}intField(t,e){if("number"!=typeof e){let s;if(isNaN(s=parseInt(String(e))))throw new Error(`Expected integer value for field ${t}, but got '${e}'!`);e=s}return this.fields[t]=`${Math.floor(e)}i`,this}floatField(t,e){if("number"!=typeof e){let s;if(isNaN(s=parseFloat(e)))throw new Error(`Expected float value for field ${t}, but got '${e}'!`);e=s}return this.fields[t]=String(e),this}stringField(t,e){return null!=e&&("string"!=typeof e&&(e=String(e)),this.fields[t]=x.quoted(e)),this}timestamp(t){return this.time=t,this}toLineProtocol(t){if(!this.name)return;let e="";if(Object.keys(this.fields).sort().forEach(t=>{if(t){const s=this.fields[t];e.length>0&&(e+=","),e+=`${x.tag(t)}=${s}`}}),0===e.length)return;let s="";const r=t&&t.defaultTags?Object.assign(Object.assign({},t.defaultTags),this.tags):this.tags;Object.keys(r).sort().forEach(t=>{if(t){const e=r[t];e&&(s+=",",s+=`${x.tag(t)}=${x.tag(e)}`)}});let n=this.time;return t&&t.convertTime&&(n=t.convertTime(n)),`${x.measurement(this.name)}${s} ${e}${void 0!==n?" "+n:""}`}toString(){const t=this.toLineProtocol(void 0);return t||`invalid point: ${JSON.stringify(this,void 0)}`}}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function X(t,e,s,r){return new(s||(s=Promise))((function(n,i){function o(t){try{l(r.next(t))}catch(t){i(t)}}function h(t){try{l(r.throw(t))}catch(t){i(t)}}function l(t){t.done?n(t.value):new s((function(e){e(t.value)})).then(o,h)}l((r=r.apply(t,e||[])).next())}))}let tt=Object.freeze({error(t,e){console.error("ERROR: "+t,e||"")},warn(t,e){console.warn("WARN: "+t,e||"")}});const et={error(t,e){tt.error(t,e)},warn(t,e){tt.warn(t,e)}};class st{constructor(t){this.options=Object.assign(Object.assign({},o),t),this.success()}nextDelay(t){const e=p(t);return e&&e>0?Math.min(e+Math.round(Math.random()*this.options.retryJitter),this.options.maxRetryDelay):(this.currentDelay?this.currentDelay=Math.min(Math.max(2*this.currentDelay,1)+Math.round(Math.random()*this.options.retryJitter),this.options.maxRetryDelay):this.currentDelay=this.options.minRetryDelay+Math.round(Math.random()*this.options.retryJitter),this.currentDelay)}success(){this.currentDelay=void 0}}class rt{constructor(t,e){this.maxLines=t,this.retryLines=e,this.size=0,this.nextRetryTime=0,this.closed=!1,this._timeoutHandle=void 0}addLines(t,e,s){if(this.closed)return;if(!t.length)return;const r=Date.now()+s;if(r>this.nextRetryTime&&(this.nextRetryTime=r),this.first&&this.size+t.length>this.maxLines){const e=this.size,s=.7*e;do{const t=this.first.next;this.size-=this.first.lines.length,this.first=t}while(this.first&&this.size+t.length>s);et.error(`RetryBuffer: ${e-this.size} oldest lines removed to keep buffer size under the limit of ${this.maxLines} lines`)}const n={lines:t,retryCount:e};this.last?(this.last.next=n,this.last=n):(this.first=n,this.last=n,this.scheduleRetry(s)),this.size+=t.length}removeLines(){if(this.first){const t=this.first;return this.first=this.first.next,this.size-=t.lines.length,this.first||(this.last=void 0),t}}scheduleRetry(t){this._timeoutHandle=setTimeout(()=>{const t=this.removeLines();t?this.retryLines(t.lines,t.retryCount).then(()=>{this.scheduleRetry(1)}).catch(t=>{this.scheduleRetry(this.nextRetryTime-Date.now())}):this._timeoutHandle=void 0},t)}flush(){return X(this,void 0,void 0,(function*(){let t;for(;t=this.removeLines();)yield this.retryLines(t.lines,t.retryCount)}))}close(){return this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=void 0),this.closed=!0,this.size}}class nt{constructor(t,e,s){this.maxChunkRecords=t,this.flushFn=e,this.scheduleSend=s,this.length=0,this.lines=new Array(t)}add(t){0===this.length&&this.scheduleSend(),this.lines[this.length]=t,this.length++,this.length>=this.maxChunkRecords&&this.flush().catch(t=>{})}flush(){const t=this.reset();return t.length>0?this.flushFn(t):Promise.resolve()}reset(){const t=this.lines.slice(0,this.length);return this.length=0,t}}class it{constructor(t,e,s,r,n){this.transport=t,this.closed=!1,this.sendOptions={method:"POST",headers:{"content-type":"text/plain; charset=utf-8"}},this._timeoutHandle=void 0,this.httpPath=`/api/v2/write?org=${encodeURIComponent(e)}&bucket=${encodeURIComponent(s)}&precision=${r}`,this.writeOptions=Object.assign(Object.assign({},h),n),this.currentTime=D[r],this.dateToProtocolTimestamp=L[r];var i;this.writeBuffer=new nt(this.writeOptions.batchSize,t=>(this._clearFlushTimeout(),this.sendBatch(t,this.writeOptions.maxRetries+1)),()=>{this.writeOptions.flushInterval>0&&(this._clearFlushTimeout(),this.closed||(this._timeoutHandle=setTimeout(()=>this.sendBatch(this.writeBuffer.reset(),this.writeOptions.maxRetries+1).catch(t=>{}),this.writeOptions.flushInterval)))}),this.sendBatch=this.sendBatch.bind(this),this.retryStrategy=(i=this.writeOptions,new st(i)),this.retryBuffer=new rt(this.writeOptions.maxBufferLines,this.sendBatch)}sendBatch(t,e){const s=this;return!this.closed&&t.length>0?new Promise((r,n)=>{this.transport.send(this.httpPath,t.join("\n"),this.sendOptions,{error(i){const o=s.writeOptions.writeFailed.call(s,i,t,s.writeOptions.maxRetries+2-e);if(o)o.then(r,n);else{if(!s.closed&&e>1&&(!(i instanceof u)||i.statusCode>=429))return et.warn(`Write to influx DB failed (remaining attempts: ${e-1}).`,i),s.retryBuffer.addLines(t,e-1,s.retryStrategy.nextDelay(i)),void n(i);et.error("Write to influx DB failed.",i),n(i)}},complete(){s.retryStrategy.success(),r()}})}):Promise.resolve()}_clearFlushTimeout(){void 0!==this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=void 0)}writeRecord(t){this.writeBuffer.add(t)}writeRecords(t){for(let e=0;e<t.length;e++)this.writeBuffer.add(t[e])}writePoint(t){const e=t.toLineProtocol(this);e&&this.writeBuffer.add(e)}writePoints(t){for(let e=0;e<t.length;e++)this.writePoint(t[e])}flush(){return X(this,void 0,void 0,(function*(){return yield this.writeBuffer.flush(),yield this.retryBuffer.flush()}))}close(){return this.writeBuffer.flush().finally(()=>{const t=this.retryBuffer.close();t&&et.error(`Retry buffer closed with ${t} items that were not written to InfluxDB!`,null),this.closed=!0})}dispose(){this._clearFlushTimeout(),this.closed=!0}useDefaultTags(t){return this.defaultTags=void 0,Object.keys(t).forEach(e=>{(this.defaultTags||(this.defaultTags={}))[e]=x.tag(t[e])}),this}convertTime(t){return void 0===t?this.currentTime():"string"==typeof t?t.length>0?t:void 0:t instanceof Date?this.dateToProtocolTimestamp(t):String("number"==typeof t?Math.floor(t):t)}}const ot={concat:(t,e)=>r.concat([t,e]),toUtf8String:(t,e,s)=>t.toString("utf-8",e,s),copy(t,e,s){const n=r.allocUnsafe(s-e);return t.copy(n,0,e,s),n}};const ht={flush:n.Z_SYNC_FLUSH,finishFlush:n.Z_SYNC_FLUSH},lt=r.allocUnsafe(0);class ct{constructor(){this.cancelled=!1}cancel(){this.cancelled=!0}isCancelled(){return this.cancelled}}class at{constructor(r){this.connectionOptions=r,this.chunkCombiner=ot;const n=t(r.url);if(this.defaultOptions=Object.assign(Object.assign(Object.assign(Object.assign({},i),r),r.transportOptions),{port:n.port,protocol:n.protocol,hostname:n.hostname}),"http:"===n.protocol)this.requestApi=e;else{if("https:"!==n.protocol)throw new Error(`Unsupported protocol "${n.protocol} in URL: "${r.url}"`);this.requestApi=s}}send(t,e,s,r){const n=this.createRequestMessage(t,e,s),i=new ct;r&&r.useCancellable&&r.useCancellable(i),this._request(n,i,r)}request(t,e,s){e?"string"!=typeof e&&(e=JSON.stringify(e)):e="";let n,i=lt;return new Promise((o,h)=>{this.send(t,e,s,{responseStarted(t){n=String(t["content-type"])},next:t=>{i=r.concat([i,t])},complete:()=>{try{n.includes("json")?o(JSON.parse(i.toString("utf8"))):n.includes("text")?o(i.toString("utf8")):o(i)}catch(t){h(t)}},error:t=>{h(t)}})})}createRequestMessage(t,e,s){const n=r.from(e,"utf-8"),i={"content-type":"application/json; charset=utf-8","User-Agent":"influxdb-client-js/1.4.0"};this.connectionOptions.token&&(i.authorization="Token "+this.connectionOptions.token);const o=Object.assign(Object.assign({},this.defaultOptions),{path:t,method:s.method,headers:Object.assign(Object.assign({},i),s.headers),body:n});return o.headers["content-length"]=n.length,o}_request(t,e,s){const r=function(t={}){let e=0;return{next:s=>{0===e&&t.next&&null!=s&&t.next(s)},error:s=>{0===e&&(e=1,t.error&&t.error(s))},complete:()=>{0===e&&(e=2,t.complete&&t.complete())},responseStarted:e=>{t.responseStarted&&t.responseStarted(e)}}}(s);if(e.isCancelled())return void r.complete();const i=this.requestApi(t,t=>{if(e.isCancelled())return t.resume(),void r.complete();t.on("aborted",()=>{r.error(new m)}),r.responseStarted(t.headers);const s=t.statusCode||600;let i;if("gzip"===t.headers["content-encoding"]?(i=n.createGunzip(ht),t.pipe(i)):i=t,i.on("error",r.error),s>=300){let e="";i.on("data",s=>{e+=s.toString(),e.length>1e3&&(e=e.slice(0,1e3),t.resume())}),i.on("end",()=>r.error(new u(s,t.statusMessage,e,t.headers["retry-after"])))}else i.on("data",s=>{e.isCancelled()?t.resume():r.next(s)}),i.on("end",r.complete)});"function"==typeof i.setTimeout&&i.setTimeout(t.timeout),i.on("timeout",()=>{r.error(new g)}),i.on("error",t=>{r.error(t)}),i.on("close",r.complete),t.body&&i.write(t.body),i.end()}}function ut(t,e){return e.toObject(t)}class ft{constructor(t,e){this.target=t,this.chunks=e,this.finished=!1}next(t){if(!this.finished)try{this.bufferReceived(t)}catch(t){this.error(t)}}error(t){this.finished||(this.finished=!0,this.target.error(t))}complete(){this.finished||(this.previous&&this.target.next(this.chunks.toUtf8String(this.previous,0,this.previous.length)),this.finished=!0,this.target.complete())}useCancellable(t){this.target.useCancellable&&this.target.useCancellable(t)}bufferReceived(t){let e,s=0;this.previous?(t=this.chunks.concat(this.previous,t),e=this.previous.length):e=0;let r=!1;for(;e<t.length;){const n=t[e];if(10===n){if(!r){const r=e>0&&13===t[e-1]?e-1:e;this.target.next(this.chunks.toUtf8String(t,s,r)),s=e+1}}else 34===n&&(r=!r);e++}this.previous=s<e?this.chunks.copy(t,s,e):void 0}}class dt{constructor(){this._reuse=!1}get reuse(){return this._reuse}set reuse(t){t&&!this.reusedValues&&(this.reusedValues=new Array(10)),this._reuse=t}withReuse(){return this.reuse=!0,this}splitLine(t){if(null==t)return this.lastSplitLength=0,[];let e=0,s=0;const r=this._reuse?this.reusedValues:[];let n=0;for(let i=0;i<t.length;i++){const o=t[i];if(","===o){if(e%2==0){const o=this.getValue(t,s,i,e);this._reuse?r[n++]=o:r.push(o),s=i+1,e=0}}else'"'===o&&e++}const i=this.getValue(t,s,t.length,e);return this._reuse?(r[n]=i,this.lastSplitLength=n+1):(r.push(i),this.lastSplitLength=r.length),r}getValue(t,e,s,r){return e===t.length?"":0===r?t.substring(e,s):2===r?t.substring(e+1,s-1):t.substring(e+1,s-1).replace(/""/gi,'"')}}function pt(t){const e=(new dt).withReuse();let s,r,n=!0,i=0;return{error(e){t.error(e)},next(o){if(""===o)n=!0,s=void 0;else{const h=e.splitLine(o),l=e.lastSplitLength;if(n){if(!s){s=new Array(l);for(let t=0;t<l;t++)s[t]=new M}if(h[0].startsWith("#")){if("#datatype"===h[0])for(let t=1;t<l;t++)s[t].dataType=h[t];else if("#default"===h[0])for(let t=1;t<l;t++)s[t].defaultValue=h[t];else if("#group"===h[0])for(let t=1;t<l;t++)s[t].group="t"===h[t][0]}else{""===h[0]?(i=1,s=s.slice(1)):i=0;for(let t=i;t<l;t++)s[t-i].label=h[t];r=new B(s),n=!1}}else t.next(h.slice(i,l),r)}},complete(){t.complete()},useCancellable(e){t.useCancellable&&t.useCancellable(e)}}}const gt="function"==typeof Symbol&&Symbol.observable||"@@observable";class mt{constructor(t,e){this.isClosed=!1;try{e({next:e=>{t.next(e)},error:e=>{this.isClosed=!0,t.error(e)},complete:()=>{this.isClosed=!0,t.complete()},useCancellable:t=>{this.cancellable=t}})}catch(e){this.isClosed=!0,t.error(e)}}get closed(){return this.isClosed}unsubscribe(){var t;null===(t=this.cancellable)||void 0===t||t.cancel(),this.isClosed=!0}}function yt(){}class wt{constructor(t,e){this.executor=t,this.decorator=e}subscribe(t,e,s){const r=function(t){const{next:e,error:s,complete:r}=t;return{next:e?e.bind(t):yt,error:s?s.bind(t):yt,complete:r?r.bind(t):yt}}("object"!=typeof t||null===t?{next:t,error:e,complete:s}:t);return new mt(this.decorator(r),this.executor)}[gt](){return this}}const bt={header:!0,delimiter:",",quoteChar:'"',commentPrefix:"#",annotations:["datatype","group","default"]},xt=t=>t;class St{constructor(t,e){this.transport=t,this.options={org:e}}with(t){return this.options=Object.assign(Object.assign({},this.options),t),this}lines(t){return new wt(this.createExecutor(t),xt)}rows(t){return new wt(this.createExecutor(t),t=>pt({next(e,s){t.next({values:e,tableMeta:s})},error(e){t.error(e)},complete(){t.complete()}}))}queryLines(t,e){this.createExecutor(t)(e)}queryRows(t,e){this.createExecutor(t)(pt(e))}collectRows(t,e=ut){const s=[];return new Promise((r,n)=>{this.queryRows(t,{next(t,r){const n=e.call(this,t,r);void 0!==n&&s.push(n)},error(t){n(t)},complete(){r(s)}})})}collectLines(t){const e=[];return new Promise((s,r)=>{this.queryLines(t,{next(t){e.push(t)},error(t){r(t)},complete(){s(e)}})})}createExecutor(t){const{org:e,type:s,gzip:r}=this.options;return n=>{this.transport.send(`/api/v2/query?org=${encodeURIComponent(e)}`,JSON.stringify(this.decorateRequest({query:t.toString(),dialect:bt,type:s})),{method:"POST",headers:{"content-type":"application/json; encoding=utf-8","accept-encoding":r?"gzip":"identity"}},new ft(n,this.transport.chunkCombiner))}}decorateRequest(t){return"function"==typeof this.options.now&&(t.now=this.options.now()),t.type=this.options.type||"flux",t}}class Ot{constructor(t){if("string"==typeof t)this._options={url:t};else{if(null===t||"object"!=typeof t)throw new a("No url or configuration specified!");this._options=t}const e=this._options.url;if("string"!=typeof e)throw new a("No url specified!");e.endsWith("/")&&(this._options.url=e.substring(0,e.length-1)),this.transport=this._options.transport||new at(this._options)}getWriteApi(t,e,s="ns",r){return new it(this.transport,t,e,s,r||this._options.writeOptions)}getQueryApi(t){return new St(this.transport,t)}}export{m as AbortError,i as DEFAULT_ConnectionOptions,o as DEFAULT_RetryDelayStrategyOptions,h as DEFAULT_WriteOptions,k as FLUX_VALUE,M as FluxTableColumn,B as FluxTableMetaData,u as HttpError,a as IllegalArgumentError,Ot as InfluxDB,Q as Point,g as RequestTimedOutError,d as canRetryHttpCall,D as currentTime,L as dateToProtocolTimestamp,x as escape,K as flux,Y as fluxBool,H as fluxDateTime,V as fluxDuration,Z as fluxExpression,I as fluxFloat,F as fluxInteger,W as fluxRegExp,U as fluxString,p as getRetryDelay,c as isStatusCodeRetriable,N as sanitizeFloat,G as toFluxValue,P as typeSerializers,O as useProcessHrtime};
//# sourceMappingURL=index.mjs.map
